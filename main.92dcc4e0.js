parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KIzB":[function(require,module,exports) {
"use strict";function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function t(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return a(e)||o(e)||r(e)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function o(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function a(e){if(Array.isArray(e))return e}var c=document.querySelector(".start"),h=document.querySelector(".restart"),d=document.querySelector(".message-start"),u=document.querySelector(".game-score"),f=document.querySelector(".info"),v=document.querySelector(".message-win"),m=document.querySelector(".message-lose"),g=document.querySelector("table"),y=s(g.rows),p=y.slice(0),b={ArrowLeft:"leftHandler",ArrowRight:"rightHandler",ArrowUp:"upHandler",ArrowDown:"downHandler"},w=new Map([[2,"field-cell--2"],[4,"field-cell--4"],[8,"field-cell--8"],[16,"field-cell--16"],[32,"field-cell--32"],[64,"field-cell--64"],[128,"field-cell--128"],[256,"field-cell--256"],[512,"field-cell--512"],[1024,"field-cell--1024"],[2048,"field-cell--2048"]]),k=function e(){i(this,e),this.isOccupied=!1,this.className=w.get(0),this.value=0,this.row=0,this.cell=0,this.td=null,this.currentPosition={x:0,y:0}},S=function(){function e(){i(this,e),this.message=null,this.startCellsNum=0,this.height=4,this.width=4,this.field=[],this.gameScore=0,this.availableCells=16,this.winningNumber=2048,this.bonusScoreNode=null,this.bonusScore=0}return t(e,[{key:"initField",value:function(e,t){if(t!==this.width){for(var i=[],s=0;s<this.height;s++){var l=new k;l.currentPosition.x=p[t].cells[s].offsetLeft,l.currentPosition.y=p[t].cells[s].offsetTop,i.push(l)}e.push(i),this.initField(e,t+1)}}},{key:"initBonusScore",value:function(){var e=document.createElement("div");e.style.position="absolute",e.className="score",f.append(e),e.classList.add("hidden"),this.bonusScoreNode=e}},{key:"generateValue",value:function(){if(0!==this.availableCells){for(this.startCellsNum=this.availableCells>=2?2:1;this.startCellsNum>0;){var e=this.getRandom(this.width),t=this.getRandom(this.height);if(!this.field[e][t].isOccupied){var i=this.field[e][t];i.isOccupied=!0,i.value=this.getRandom(0,1),this.renderRandomTile(i,p[e].cells[t]),this.startCellsNum--}}this.checkAvailableCells()}}},{key:"getRandom",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t.length>1){var s=t[0],l=t[1];return Math.random()*(l-s)+s<=.1?4:2}return parseInt(Math.random()*t-1e-4)}},{key:"renderRandomTile",value:function(e,t){var i=w.get(e.value);e.td=document.createElement("td"),e.td.className="field-cell",e.td.style.position="absolute",e.td.style.lineHeight="75px",e.td.style.zIndex=2,e.td.style.left=e.currentPosition.x+"px",e.td.style.top=e.currentPosition.y+"px",e.td.innerText=e.value,e.td.classList.toggle(i),e.className=i,e.td.classList.add("animate"),t.append(e.td)}},{key:"renderScore",value:function(){u.innerText=this.gameScore}},{key:"updateBonusScore",value:function(e){e.classList.remove("hidden"),e.classList.add("move"),e.innerText="+".concat(this.bonusScore),u.innerText=this.gameScore,setTimeout(function(){e.classList.remove("move"),e.classList.add("hidden"),this.bonusScore=0}.bind(this),500)}},{key:"moveUp",value:function(){for(var e=0;e<this.height;e++)for(var t=0;t<this.width;t++)if(this.field[t][e].isOccupied){for(var i=t;i>0&&!this.field[i-1][e].isOccupied;)this.shiftNotEmptyCells(this.field[i][e],this.field[i-1][e]),i--;i>0&&this.field[i-1][e].value===this.field[i][e].value&&(this.mergeCells(this.field[i][e],this.field[i-1][e]),this.checkTileScore(this.field[i-1][e]))}}},{key:"moveDown",value:function(){for(var e=0;e<this.width;e++)for(var t=this.height-1;t>=0;t--)if(this.field[t][e].isOccupied){for(var i=t;i<this.height-1&&!this.field[i+1][e].isOccupied;)this.shiftNotEmptyCells(this.field[i][e],this.field[i+1][e]),i++;i<this.height-1&&this.field[i+1][e].value===this.field[i][e].value&&(this.mergeCells(this.field[i][e],this.field[i+1][e]),this.checkTileScore(this.field[i+1][e]))}}},{key:"moveLeft",value:function(){for(var e=0;e<this.width;e++)for(var t=0;t<this.height;t++)if(this.field[e][t].isOccupied){for(var i=t;i>0&&!this.field[e][i-1].isOccupied;)this.shiftNotEmptyCells(this.field[e][i],this.field[e][i-1]),i--;i>0&&this.field[e][i-1].value===this.field[e][i].value&&(this.mergeCells(this.field[e][i],this.field[e][i-1]),this.checkTileScore(this.field[e][i-1]))}}},{key:"moveRight",value:function(){for(var e=0;e<this.width;e++)for(var t=this.height-1;t>=0;t--)if(this.field[e][t].isOccupied){for(var i=t;i<this.height-1&&!this.field[e][i+1].isOccupied;)this.shiftNotEmptyCells(this.field[e][i],this.field[e][i+1]),i++;i<this.height-1&&this.field[e][i+1].value===this.field[e][i].value&&(this.mergeCells(this.field[e][i],this.field[e][i+1]),this.checkTileScore(this.field[e][i+1]))}}},{key:"getDirection",value:function(e){switch(e){case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight();break;case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown()}this.renderScore()}},{key:"shiftNotEmptyCells",value:function(e,t){t.value=e.value,t.isOccupied=!0,t.td=e.td,t.td.classList.toggle(w.get(t.value)),e.value=0,e.isOccupied=!1,e.td.classList.toggle(w.get(t.value)),t.td.style.left=t.currentPosition.x+"px",t.td.style.top=t.currentPosition.y+"px",t.td.innerText=t.value,e.td=null}},{key:"mergeCells",value:function(e,t){t.value*=2,this.gameScore+=t.value,this.bonusScore+=t.value,this.updateBonusScore(this.bonusScoreNode),null!==t.td&&t.td.remove(),t.td=e.td,t.td.style.left=t.currentPosition.x+"px",t.td.style.top=t.currentPosition.y+"px",t.td.innerText=t.value,t.td.classList.toggle(w.get(t.value)),t.td.classList.remove("animate"),t.td.classList.toggle("pulse"),setTimeout(function(){null!==t.td&&t.td.classList.remove("pulse")},500),e.value=0,e.isOccupied=!1}},{key:"checkAvailableCells",value:function(){var e=0;this.field.forEach(function(t){t.forEach(function(t){e+=!1===t.isOccupied?1:0})}),this.availableCells=e,0===this.availableCells&&!1===this.getPossibleMoves()&&this.stopGame(m)}},{key:"checkTileScore",value:function(e){return e.value!==this.winningNumber||this.stopGame(v)}},{key:"getPossibleMoves",value:function(){for(var e=!1,t=0;t<this.width;t++)for(var i=0;i<this.height;i++)if(t>0&&(e=e||this.field[t-1][i].value===this.field[t][i].value),t<this.width-1&&(e=e||this.field[t+1][i].value===this.field[t][i].value),i>0&&(e=e||this.field[t][i-1].value===this.field[t][i].value),i<this.height-1&&(e=e||this.field[t][i+1].value===this.field[t][i].value),!0===e)return!0;return e}},{key:"stopGame",value:function(e){this.message=e,this.renderScore(),e.classList.remove("hidden"),document.removeEventListener("keydown",C)}},{key:"resetGameDependencies",value:function(){var e=this;this.field.forEach(function(t){t.forEach(function(t){null!=t.td&&(t.td.remove(),t.td=null),t.value=0,t.isOccupied=!1,e.className=w.get(0)})}),this.gameScore=0,this.bonusScore=0,this.startCellsNum=0,this.availableCells=16}},{key:"gameLogic",value:function(e){b.hasOwnProperty(e.key)&&(this.getDirection(e.key),this.checkAvailableCells(),this.generateValue(),this.renderScore())}},{key:"start",value:function(e){e.classList.add("hidden"),this.initField(this.field,0),this.generateValue(),this.renderScore(),this.initBonusScore()}},{key:"restart",value:function(){null!==this.message&&this.message.classList.add("hidden"),this.resetGameDependencies(),this.generateValue(),this.renderScore()}}]),e}(),L=new S,C=function(e){L.gameLogic(e)};c.addEventListener("click",function(){L.start(d),c.classList.add("hidden"),h.classList.remove("hidden"),document.addEventListener("keydown",C)},{once:!0}),h.addEventListener("click",function(){L.restart(),document.addEventListener("keydown",C)});
},{}]},{},["KIzB"], null)
//# sourceMappingURL=main.92dcc4e0.js.map